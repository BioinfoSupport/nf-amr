---
title: "Isolate Report"
author: "`r Sys.getenv('USER')`"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    flexdashboard::flex_dashboard:
        orientation: row
params:
  rds: "results/r62b15.hdr/isolate_data.rds"
---

```{r setup}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(flexdashboard)
```


```{r}
x <- readRDS(params$rds)
```


# Metadata

Row
-------------------------

### Metadata
```{r}
flexdashboard::valueBox(x$meta$assembly_id,"Assembly Id")
```

Row
-------------------------
### Organism
```{r}
valueBox(x$meta$org_org_name,"Organism name")
```

### ANI
```{r}
valueBox(x$meta$org_org_ani,"ANI")
```



# Assembly QC

Row
-------------------------
### Total length
```{r}
valueBox(sprintf("%s bp",format(sum(x$contigs$contig_len),big.mark="'")),"Total length")
```

### Number of contig
```{r}
valueBox(nrow(x$contigs),"Contigs")
```

### N50
```{r}
valueBox(sprintf("%s bp",format(Biostrings::N50(x$contigs$contig_len),big.mark="'")),"N50")
```


Row
-------------------------

### Contig size distribution

```{r}
x$contigs |>
	mutate(contig_id = fct_reorder(contig_id,contig_len,mean)) |>
	ggplot() + 
		facet_grid(assembly_id~.) +
		geom_segment(aes(x=0,y=contig_id,xend=contig_len,yend=contig_id)) + 
		scale_x_continuous(labels = scales::label_number(scale_cut = scales::cut_short_scale())) +
		xlab("Contig size (bp)") +
		theme_bw()
```




# Plasmids

```{r}
x$plasmidfinder
```








